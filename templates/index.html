<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FlowCast ‚Äî Planner de Conte√∫do</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root{--bg:#060b18;--card:#0c1527;--elev:#111d35;--hover:#162544;--brd:#1a2d4d;--pri:#2563eb;--pri-l:#60a5fa;--pri-s:rgba(37,99,235,.08);--pri-m:rgba(37,99,235,.15);--cyan:#22d3ee;--grn:#10b981;--red:#ef4444;--t1:#e8edf5;--t2:#8899b5;--t3:#4a5e80;--r:12px;--rs:8px;--f:'Outfit',sans-serif;--fm:'IBM Plex Mono',monospace;--glow:0 0 30px rgba(37,99,235,.15)}
        *,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
        body{font-family:var(--f);background:var(--bg);color:var(--t1);min-height:100vh;-webkit-font-smoothing:antialiased}
        ::selection{background:var(--pri);color:#fff}
        ::-webkit-scrollbar{width:6px}::-webkit-scrollbar-track{background:transparent}::-webkit-scrollbar-thumb{background:var(--brd);border-radius:10px}::-webkit-scrollbar-thumb:hover{background:var(--pri)}
        button{font-family:var(--f)}
        .app{display:flex;min-height:100vh}

        /* SIDEBAR */
        .side{width:270px;background:var(--card);border-right:1px solid var(--brd);position:fixed;top:0;left:0;bottom:0;display:flex;flex-direction:column;z-index:100}
        .side-hd{padding:24px;border-bottom:1px solid var(--brd)}
        .logo{display:flex;align-items:center;gap:12px;text-decoration:none}
        .logo-i{width:38px;height:38px;background:linear-gradient(135deg,var(--pri),var(--cyan));border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:18px;box-shadow:0 4px 15px rgba(37,99,235,.3)}
        .logo-t{font-size:22px;font-weight:800;letter-spacing:-.5px;background:linear-gradient(135deg,#fff,var(--pri-l));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
        .side-nav{flex:1;padding:20px 14px;overflow-y:auto}
        .ns{margin-bottom:28px}
        .ns-t{display:block;padding:0 12px;margin-bottom:10px;font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:2px;color:var(--t3)}
        .nl{display:flex;align-items:center;gap:12px;padding:11px 14px;font-size:14px;font-weight:500;color:var(--t2);border-radius:var(--rs);text-decoration:none;margin-bottom:3px;transition:all .2s;border:1px solid transparent}
        .nl:hover{background:var(--elev);color:var(--t1)}
        .nl.on{background:var(--pri-m);color:var(--pri-l);border-color:rgba(37,99,235,.3)}
        .nl svg{width:18px;height:18px;opacity:.6;flex-shrink:0}.nl.on svg{opacity:1}
        .nb{margin-left:auto;padding:2px 8px;font-size:10px;font-weight:700;border-radius:100px;color:#fff}
        .side-ft{padding:18px 16px;border-top:1px solid var(--brd)}
        .badge{display:block;text-align:center;padding:10px 16px;background:linear-gradient(135deg,var(--pri-m),var(--pri-s));border:1px solid rgba(37,99,235,.25);border-radius:100px;font-size:12px;font-weight:600;color:var(--pri-l);letter-spacing:.5px}

        /* MAIN */
        .mn{flex:1;margin-left:270px;display:flex;flex-direction:column}
        .topb{display:flex;align-items:center;justify-content:space-between;padding:16px 36px;background:var(--card);border-bottom:1px solid var(--brd);position:sticky;top:0;z-index:50}
        .topb h1{font-size:18px;font-weight:600}
        .up{display:flex;align-items:center;gap:10px;padding:6px 14px 6px 6px;background:var(--elev);border:1px solid var(--brd);border-radius:100px}
        .ua{width:32px;height:32px;background:linear-gradient(135deg,var(--pri),var(--cyan));border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:700;color:#fff}
        .up span{font-size:13px;font-weight:500;color:var(--t2)}
        .ct{flex:1;padding:36px}
        .pl{max-width:1400px;margin:0 auto}

        /* HEADER */
        .ph{display:flex;justify-content:space-between;align-items:center;margin-bottom:28px;flex-wrap:wrap;gap:16px}
        .ph h1{font-size:30px;font-weight:800;letter-spacing:-.5px;margin-bottom:4px}
        .ph h1 em{font-style:normal;background:linear-gradient(135deg,var(--pri-l),var(--cyan));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
        .ph p{color:var(--t2);font-size:14px}
        .sts{display:flex;gap:16px}
        .st{text-align:center;padding:14px 24px;background:var(--card);border:1px solid var(--brd);border-radius:var(--r);min-width:90px;transition:all .2s}
        .st:hover{border-color:var(--pri);box-shadow:var(--glow)}
        .st b{display:block;font-size:26px;font-weight:800;color:var(--pri-l);line-height:1;margin-bottom:4px}
        .st small{font-size:11px;font-weight:600;color:var(--t3);text-transform:uppercase;letter-spacing:1px}

        /* TABS */
        .tabs{display:flex;gap:4px;margin-bottom:28px;border-bottom:1px solid var(--brd)}
        .tab{display:flex;align-items:center;gap:8px;padding:14px 24px;background:none;border:none;color:var(--t3);font-size:14px;font-weight:600;cursor:pointer;border-bottom:2px solid transparent;margin-bottom:-1px;transition:all .2s}
        .tab:hover{color:var(--t2)}.tab.on{color:var(--pri-l);border-bottom-color:var(--pri)}
        .pn{display:none;animation:fu .3s ease}.pn.on{display:block}
        @keyframes fu{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}

        /* FLUXO */
        .fc{display:flex;justify-content:space-between;align-items:center;gap:16px;margin-bottom:20px;flex-wrap:wrap}
        .prs{display:flex;gap:6px;flex-wrap:wrap}
        .per{padding:8px 18px;background:var(--card);border:1px solid var(--brd);border-radius:100px;color:var(--t2);font-family:var(--f);font-size:13px;font-weight:500;cursor:pointer;transition:all .2s}
        .per:hover{border-color:var(--pri);color:var(--t1)}.per.on{background:var(--pri);border-color:var(--pri);color:#fff;box-shadow:0 4px 15px rgba(37,99,235,.3)}
        .fc select{padding:8px 16px;background:var(--card);border:1px solid var(--brd);border-radius:100px;color:var(--t1);font-family:var(--f);font-size:13px;outline:none}
        .fc select:focus{border-color:var(--pri)}
        .pg{background:var(--card);border:1px solid var(--brd);border-radius:var(--r);padding:18px 22px;margin-bottom:24px}
        .pgi{display:flex;justify-content:space-between;margin-bottom:10px;font-size:14px;font-weight:500}
        .pgp{font-weight:700;color:var(--pri-l)}
        .pgb{height:6px;background:var(--elev);border-radius:3px;overflow:hidden}
        .pgf{height:100%;background:linear-gradient(90deg,var(--pri),var(--cyan));border-radius:3px;transition:width .4s;box-shadow:0 0 12px rgba(37,99,235,.4)}
        .tks{display:flex;flex-direction:column;gap:6px}
        .dh{padding:12px 16px;background:var(--elev);border-radius:var(--rs);font-weight:600;font-size:13px;color:var(--t2);margin-top:18px;letter-spacing:.3px}.dh:first-child{margin-top:0}
        .tk{display:flex;align-items:center;gap:16px;padding:16px 20px;background:var(--card);border:1px solid var(--brd);border-radius:var(--r);cursor:pointer;transition:all .25s}
        .tk:hover{border-color:var(--pri);transform:translateX(4px);box-shadow:var(--glow)}
        .tk.dn{opacity:.45}.tk.dn .tn{color:var(--t3)}
        .ck{width:24px;height:24px;border:2px solid var(--brd);border-radius:6px;display:flex;align-items:center;justify-content:center;font-size:13px;flex-shrink:0;color:transparent;transition:all .2s}
        .tk.dn .ck{background:var(--pri);border-color:var(--pri);color:#fff;box-shadow:0 2px 8px rgba(37,99,235,.3)}
        .ttime{font-family:var(--fm);font-size:13px;color:var(--t3);min-width:50px}
        .tch{display:flex;align-items:center;gap:10px;flex:1}
        .ti{width:34px;height:34px;border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:16px}
        .tn{font-weight:500;font-size:14px}

        /* CANAIS */
        .chd{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px}.chd h2{font-size:20px;font-weight:700}
        .cg{display:grid;grid-template-columns:repeat(auto-fill,minmax(340px,1fr));gap:16px}
        .cc{display:flex;align-items:center;gap:16px;padding:22px;background:var(--card);border:1px solid var(--brd);border-radius:var(--r);transition:all .25s}
        .cc:hover{border-color:var(--pri);box-shadow:var(--glow)}
        .ci{width:50px;height:50px;border-radius:var(--r);display:flex;align-items:center;justify-content:center;font-size:24px;flex-shrink:0}
        .cn{flex:1;min-width:0}.cn h3{font-size:16px;font-weight:700;margin-bottom:4px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.cn p{font-size:13px;color:var(--t3)}
        .ca{display:flex;gap:8px}

        /* PROMPTS */
        .prl{display:grid;grid-template-columns:260px 1fr;gap:24px}
        .prs2{background:var(--card);border:1px solid var(--brd);border-radius:var(--r);padding:18px;height:fit-content}
        .prs2 h3{font-size:12px;font-weight:700;margin-bottom:16px;color:var(--t3);text-transform:uppercase;letter-spacing:1.5px}
        .pcl{display:flex;flex-direction:column;gap:4px}
        .pc{display:flex;align-items:center;gap:10px;padding:10px 12px;background:none;border:none;border-radius:var(--rs);color:var(--t2);font-family:var(--f);font-size:14px;cursor:pointer;text-align:left;width:100%;transition:all .2s}
        .pc:hover{background:var(--elev);color:var(--t1)}.pc.on{background:var(--pri-m);color:var(--pri-l)}
        .pcn{margin-left:auto;font-size:11px;background:var(--elev);padding:2px 8px;border-radius:10px;font-weight:600}
        .prm{min-width:0}
        .prh{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.prh h2{font-size:20px;font-weight:700}
        .prls{display:flex;flex-direction:column;gap:12px}
        .prc{display:flex;align-items:center;gap:16px;padding:18px 22px;background:var(--card);border:1px solid var(--brd);border-radius:var(--r);cursor:pointer;transition:all .25s}
        .prc:hover{border-color:var(--pri);box-shadow:var(--glow)}
        .pic{width:42px;height:42px;background:var(--pri-m);border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:18px;color:var(--pri-l);flex-shrink:0}
        .pin{flex:1;min-width:0}.pin h4{font-size:15px;font-weight:600;margin-bottom:4px}.pin p{font-size:13px;color:var(--t3);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
        .pa{display:flex;gap:8px}

        /* GENERIC */
        .em{text-align:center;padding:60px 20px;color:var(--t3)}
        .emi{width:56px;height:56px;background:var(--pri-s);border-radius:16px;display:flex;align-items:center;justify-content:center;font-size:24px;margin:0 auto 16px}
        .em p{font-size:15px;margin-bottom:6px;color:var(--t2)}.em small{display:block;font-size:13px}
        .btn{display:inline-flex;align-items:center;gap:8px;padding:10px 22px;border:none;border-radius:100px;font-family:var(--f);font-size:14px;font-weight:600;cursor:pointer;transition:all .25s}
        .bp{background:linear-gradient(135deg,var(--pri),#1d4ed8);color:#fff}.bp:hover{transform:translateY(-2px);box-shadow:0 6px 20px rgba(37,99,235,.4)}
        .bs{background:var(--elev);color:var(--t2);border:1px solid var(--brd)}.bs:hover{background:var(--hover);color:var(--t1)}
        .bsm{padding:6px 14px;font-size:12px}
        .bi{width:36px;height:36px;display:flex;align-items:center;justify-content:center;background:var(--elev);border:1px solid var(--brd);border-radius:var(--rs);color:var(--t2);cursor:pointer;transition:all .2s;padding:0;font-size:14px}
        .bi:hover{background:var(--pri);border-color:var(--pri);color:#fff}.bi.dg:hover{background:var(--red);border-color:var(--red)}

        /* MODAL */
        .mo{display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.75);backdrop-filter:blur(4px);z-index:1000;align-items:center;justify-content:center;padding:20px}
        .mo.on{display:flex}
        .mb{background:var(--card);border:1px solid var(--brd);border-radius:16px;width:100%;max-width:520px;max-height:90vh;overflow-y:auto;box-shadow:0 16px 50px rgba(0,0,0,.4);animation:mi .25s}
        @keyframes mi{from{opacity:0;transform:scale(.95) translateY(10px)}to{opacity:1;transform:scale(1) translateY(0)}}
        .mb.lg{max-width:720px}
        .mh{display:flex;justify-content:space-between;align-items:center;padding:22px 26px;border-bottom:1px solid var(--brd)}
        .mh h3{font-size:18px;font-weight:700}
        .mx{width:32px;height:32px;display:flex;align-items:center;justify-content:center;background:none;border:none;color:var(--t3);font-size:22px;cursor:pointer;border-radius:var(--rs);transition:all .2s}
        .mx:hover{background:var(--elev);color:var(--t1)}
        .mbd{padding:26px}
        .mf{display:flex;justify-content:flex-end;gap:12px;padding-top:18px;border-top:1px solid var(--brd);margin-top:18px}

        /* FORMS */
        .fg{margin-bottom:20px}
        .fg label{display:block;font-size:13px;font-weight:600;margin-bottom:8px;color:var(--t2)}
        .fg input,.fg select,.fg textarea{width:100%;padding:12px 16px;background:var(--elev);border:1px solid var(--brd);border-radius:var(--rs);font-size:14px;font-family:var(--f);color:var(--t1);outline:none;transition:border-color .2s}
        .fg input:focus,.fg select:focus,.fg textarea:focus{border-color:var(--pri);box-shadow:0 0 0 3px rgba(37,99,235,.1)}
        .fg small{display:block;margin-top:6px;font-size:12px;color:var(--t3)}
        .fgr{display:grid;grid-template-columns:1fr 1fr;gap:20px}
        .pk{display:flex;gap:8px;flex-wrap:wrap}
        .pp{width:42px;height:42px;display:flex;align-items:center;justify-content:center;background:var(--elev);border:2px solid var(--brd);border-radius:var(--rs);font-size:20px;cursor:pointer;transition:all .2s}
        .pp.on{border-color:var(--pri);box-shadow:0 0 0 3px rgba(37,99,235,.2)}
        .tms{display:flex;flex-direction:column;gap:8px;margin-bottom:12px}
        .tr{display:flex;gap:8px}.tr input{flex:1}
        .taf{display:flex;justify-content:space-between;align-items:center;margin-top:8px}
        .taf span{font-size:12px;color:var(--t3);font-family:var(--fm)}
        .vp{padding:26px;max-height:400px;overflow-y:auto}
        .vp pre{white-space:pre-wrap;word-wrap:break-word;font-family:var(--fm);font-size:13px;line-height:1.7;color:var(--t2)}

        /* TOAST */
        .toast{position:fixed;bottom:24px;right:24px;padding:14px 24px;background:var(--card);border:1px solid var(--grn);border-radius:var(--r);color:var(--grn);font-size:14px;font-weight:500;box-shadow:0 8px 30px rgba(0,0,0,.3);transform:translateY(100px);opacity:0;transition:all .3s;z-index:2000}
        .toast.on{transform:translateY(0);opacity:1}

        /* CONTEUDOS */
        .ctl{display:grid;grid-template-columns:260px 1fr;gap:24px}
        .cts2{background:var(--card);border:1px solid var(--brd);border-radius:var(--r);padding:18px;height:fit-content}
        .cts2 h3{font-size:12px;font-weight:700;margin-bottom:16px;color:var(--t3);text-transform:uppercase;letter-spacing:1.5px}
        .ctm{min-width:0}
        .cth{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.cth h2{font-size:20px;font-weight:700}
        .ctls{display:flex;flex-direction:column;gap:8px}
        .cti{display:flex;align-items:center;gap:14px;padding:16px 20px;background:var(--card);border:1px solid var(--brd);border-radius:var(--r);transition:all .25s}
        .cti:hover{border-color:var(--pri);box-shadow:var(--glow)}
        .cti.pub{opacity:.55}
        .ctthumb{width:64px;height:48px;border-radius:6px;object-fit:cover;flex-shrink:0;cursor:pointer;border:1px solid var(--brd);transition:transform .2s}
        .ctthumb:hover{transform:scale(1.05)}
        .ctnoimg{width:64px;height:48px;border-radius:6px;flex-shrink:0;background:var(--bg);border:1px dashed var(--brd);display:flex;align-items:center;justify-content:center;font-size:18px;color:var(--t3)}
        .ctlb{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.85);z-index:10000;display:flex;align-items:center;justify-content:center;opacity:0;visibility:hidden;transition:all .3s;cursor:pointer}
        .ctlb.on{opacity:1;visibility:visible}
        .ctlb img{max-width:90%;max-height:85vh;border-radius:12px;box-shadow:0 20px 60px rgba(0,0,0,.5)}
        .ctlbx{position:absolute;top:20px;right:24px;font-size:32px;color:#fff;cursor:pointer;line-height:1}
        .thumbup{margin-top:8px}
        .thumbup label{display:inline-flex;align-items:center;gap:8px;padding:8px 16px;background:var(--bg);border:1px dashed var(--brd);border-radius:8px;cursor:pointer;font-size:13px;color:var(--t2);transition:all .2s}
        .thumbup label:hover{border-color:var(--pri);color:var(--t1)}
        .thumbup input{display:none}
        .thumbprev{margin-top:8px;position:relative;display:inline-block}
        .thumbprev img{width:120px;height:80px;object-fit:cover;border-radius:8px;border:1px solid var(--brd)}
        .thumbprev .thumbrm{position:absolute;top:-6px;right:-6px;width:22px;height:22px;background:var(--red);color:#fff;border:none;border-radius:50%;font-size:12px;cursor:pointer;display:flex;align-items:center;justify-content:center}
        .ctck{width:26px;height:26px;border:2px solid var(--brd);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:13px;flex-shrink:0;color:transparent;cursor:pointer;transition:all .2s}
        .cti.pub .ctck{background:var(--grn);border-color:var(--grn);color:#fff;box-shadow:0 2px 8px rgba(16,185,129,.3)}
        .ctinf{flex:1;min-width:0}
        .ctinf h4{font-size:14px;font-weight:600;margin-bottom:2px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
        .ctinf span{font-size:12px;color:var(--t3);font-family:var(--fm)}
        .cti.pub .ctinf h4{text-decoration:line-through;color:var(--t3)}
        .ctfl{display:flex;gap:6px;margin-bottom:16px;flex-wrap:wrap}
        .ctfb{padding:6px 14px;background:var(--card);border:1px solid var(--brd);border-radius:100px;color:var(--t2);font-family:var(--f);font-size:12px;font-weight:600;cursor:pointer;transition:all .2s}
        .ctfb:hover{border-color:var(--pri);color:var(--t1)}.ctfb.on{background:var(--pri);border-color:var(--pri);color:#fff}

        /* Achievements - Trello style board */
        .achboard{display:flex;gap:16px;overflow-x:auto;padding-bottom:16px;min-height:calc(100vh - 200px)}
        .achcol{min-width:280px;max-width:280px;background:var(--card);border:1px solid var(--brd);border-radius:var(--r);display:flex;flex-direction:column;max-height:calc(100vh - 220px)}
        .achcolhd{padding:14px 16px;border-bottom:1px solid var(--brd);display:flex;align-items:center;gap:10px;flex-shrink:0}
        .achcolhd .icon{font-size:18px}
        .achcolhd h3{font-size:14px;font-weight:600;flex:1;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
        .achcolhd .cnt{font-size:11px;background:var(--bg);padding:2px 8px;border-radius:100px;color:var(--t3)}
        .achcards{flex:1;overflow-y:auto;padding:12px;display:flex;flex-direction:column;gap:10px}
        .achcard{background:var(--bg);border:1px solid var(--brd);border-radius:10px;padding:12px;cursor:pointer;transition:all .2s}
        .achcard:hover{border-color:var(--pri);transform:translateY(-2px);box-shadow:0 4px 12px rgba(0,0,0,.2)}
        .achcardimg{width:100%;height:120px;object-fit:cover;border-radius:6px;margin-bottom:10px}
        .achcardnoimg{width:100%;height:80px;background:var(--card);border:1px dashed var(--brd);border-radius:6px;margin-bottom:10px;display:flex;align-items:center;justify-content:center;font-size:24px;color:var(--t3)}
        .achcard h4{font-size:13px;font-weight:600;margin-bottom:4px;line-height:1.3}
        .achcard p{font-size:11px;color:var(--t2);margin-bottom:8px;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}
        .achcard .meta{font-size:10px;color:var(--t3)}
        .achcard .actions{display:flex;gap:6px;margin-top:8px;opacity:0;transition:opacity .2s}
        .achcard:hover .actions{opacity:1}
        .achcard .actions button{padding:4px 8px;font-size:11px}
        .achcoladd{padding:12px;border-top:1px solid var(--brd);flex-shrink:0}
        .achcoladd button{width:100%;padding:10px;background:transparent;border:1px dashed var(--brd);border-radius:8px;color:var(--t2);font-size:12px;cursor:pointer;transition:all .2s}
        .achcoladd button:hover{border-color:var(--pri);color:var(--pri);background:rgba(99,102,241,.05)}
        .achboardempty{text-align:center;padding:60px 20px;color:var(--t3)}
        .achboardempty p{margin-top:12px}
        .achhd{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}
        .achhd h2{font-size:18px;font-weight:700}

        /* Page switching */
        .page{display:none}
        .page.on{display:block}

        @media(max-width:992px){.side{transform:translateX(-100%)}.mn{margin-left:0}}
        @media(max-width:900px){.prl{grid-template-columns:1fr}.prs2{display:none}.fgr{grid-template-columns:1fr}.ctl{grid-template-columns:1fr}}
        @media(max-width:600px){.ct{padding:20px}.ph{flex-direction:column;align-items:flex-start}.sts{width:100%;justify-content:space-between}.prs{width:100%;overflow-x:auto;flex-wrap:nowrap;padding-bottom:8px}.cg{grid-template-columns:1fr}.achi{flex-direction:column}.achimg,.achnoimg{width:100%;height:140px}}
    </style>
</head>
<body>
<div class="app">
    <!-- SIDEBAR -->
    <aside class="side">
        <div class="side-hd"><a href="/" class="logo"><div class="logo-i">‚ö°</div><span class="logo-t">FlowCast</span></a></div>
        <nav class="side-nav">
            <div class="ns"><span class="ns-t">Ferramentas</span>
                <a href="#" class="nl on" data-nav="planner"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="4" width="18" height="18" rx="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg><span>Planner</span></a>
                <a href="#" class="nl" data-nav="conquistas"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="8" r="6"/><path d="M15.477 12.89L17 22l-5-3-5 3 1.523-9.11"/></svg><span>Conquistas</span></a>
            </div>
            <div class="ns"><span class="ns-t">Conta</span>
                <a href="#" class="nl" id="btnLogout2"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg><span>Sair</span></a>
            </div>
        </nav>
        <div class="side-ft"><span class="badge">FlowCast PRO</span></div>
    </aside>

    <!-- MAIN -->
    <div class="mn">
        <!-- PAGE: PLANNER -->
        <div id="pagePlanner" class="page on">
            <header class="topb"><h1>Planner</h1><div style="display:flex;align-items:center;gap:12px"><div class="up"><div class="ua">{{ user_name[:2]|upper }}</div><span>{{ user_name }}</span></div><button class="btn bs bsm" id="btnLogout" style="border-radius:100px">Sair</button></div></header>
            <main class="ct"><div class="pl">
                <div class="ph"><div><h1>üìã Flow<em>Cast</em> Planner</h1><p>Organize sua produ√ß√£o de conte√∫do</p></div>
                    <div class="sts"><div class="st"><b id="sT">0</b><small>Hoje</small></div><div class="st"><b id="sW">0</b><small>Semana</small></div><div class="st"><b id="sC">0</b><small>Canais</small></div></div>
                </div>
                <div class="tabs">
                    <button class="tab on" data-t="fluxo">üìÖ Fluxo</button>
                    <button class="tab" data-t="canais">üì∫ Canais</button>
                    <button class="tab" data-t="conteudos">üé¨ Conte√∫dos</button>
                    <button class="tab" data-t="prompts">üìÑ Prompts</button>
                </div>
                <div id="pFluxo" class="pn on"></div>
                <div id="pCanais" class="pn"></div>
                <div id="pConteudos" class="pn"></div>
                <div id="pPrompts" class="pn"></div>
            </div></main>
        </div>

        <!-- PAGE: CONQUISTAS -->
        <div id="pageConquistas" class="page">
            <header class="topb"><h1>Conquistas</h1><div style="display:flex;align-items:center;gap:12px"><div class="up"><div class="ua">{{ user_name[:2]|upper }}</div><span>{{ user_name }}</span></div><button class="btn bs bsm" id="btnLogout3" style="border-radius:100px">Sair</button></div></header>
            <main class="ct"><div class="pl">
                <div class="ph"><div><h1>üèÜ Conquistas</h1><p>Documente seus recordes e marcos importantes</p></div></div>
                <div id="pConquistas"></div>
            </div></main>
        </div>
    </div>
</div>

<!-- MODALS -->
<div class="mo" id="mCh"><div class="mb"><div class="mh"><h3 id="mChT">Novo Canal</h3><button class="mx" data-close="mCh">&times;</button></div><div class="mbd" id="mChB"></div></div></div>
<div class="mo" id="mPr"><div class="mb lg"><div class="mh"><h3 id="mPrT">Novo Prompt</h3><button class="mx" data-close="mPr">&times;</button></div><div class="mbd" id="mPrB"></div></div></div>
<div class="mo" id="mV"><div class="mb lg"><div class="mh"><h3 id="mVT">Prompt</h3><button class="mx" data-close="mV">&times;</button></div><div class="vp"><pre id="mVP"></pre></div><div style="padding:0 26px 22px;display:flex;justify-content:flex-end;gap:12px"><button class="btn bs" data-close="mV">Fechar</button><button class="btn bp" id="mVC">üìã Copiar</button></div></div></div>
<div class="mo" id="mConf"><div class="mb" style="max-width:400px"><div class="mh"><h3>Confirma√ß√£o</h3><button class="mx" data-close="mConf">&times;</button></div><div class="mbd" style="text-align:center"><p id="mConfMsg" style="font-size:15px;color:var(--t2);margin-bottom:24px"></p><div style="display:flex;justify-content:center;gap:12px"><button class="btn bs" data-close="mConf">Cancelar</button><button class="btn bp" id="mConfYes" style="background:linear-gradient(135deg,var(--red),#dc2626)">Excluir</button></div></div></div></div>
<div class="mo" id="mCt"><div class="mb"><div class="mh"><h3 id="mCtT">Novo Conte√∫do</h3><button class="mx" data-close="mCt">&times;</button></div><div class="mbd" id="mCtB"></div></div></div>
<div class="mo" id="mAch"><div class="mb"><div class="mh"><h3 id="mAchT">Nova Conquista</h3><button class="mx" data-close="mAch">&times;</button></div><div class="mbd" id="mAchB"></div></div></div>
<div class="ctlb" id="ctLightbox" onclick="this.classList.remove('on')"><span class="ctlbx">&times;</span><img id="ctLbImg" src="" alt="Thumbnail"></div>
<div class="toast" id="toast"></div>

<script>
(function(){
    // ‚îÄ‚îÄ‚îÄ Helpers ‚îÄ‚îÄ‚îÄ
    var confirmCb = null;
    function esc(t){var d=document.createElement('div');d.textContent=t;return d.innerHTML}
    function toast(m){var t=document.getElementById('toast');t.textContent=m;t.classList.add('on');setTimeout(function(){t.classList.remove('on')},2500)}
    function showConfirm(msg,cb){confirmCb=cb;document.getElementById('mConfMsg').textContent=msg;document.getElementById('mConf').classList.add('on')}
    function api(url,opts){return fetch(url,Object.assign({headers:{'Content-Type':'application/json'}},opts||{})).then(function(r){return r.json()})}

    var period='today', curCh=null, allChannels=[];

    // ‚îÄ‚îÄ‚îÄ Load Stats ‚îÄ‚îÄ‚îÄ
    function loadStats(){
        api('/api/stats').then(function(d){
            document.getElementById('sT').textContent=d.today;
            document.getElementById('sW').textContent=d.week;
            document.getElementById('sC').textContent=d.channels;
        });
    }

    // ‚îÄ‚îÄ‚îÄ Load Channels (shared) ‚îÄ‚îÄ‚îÄ
    function loadChannels(){
        return api('/api/channels').then(function(chs){allChannels=chs;return chs});
    }

    // ‚îÄ‚îÄ‚îÄ Fluxo ‚îÄ‚îÄ‚îÄ
    function renderFluxo(){
        var fv=document.querySelector('#fFlt')?document.querySelector('#fFlt').value:'';
        api('/api/tasks?period='+period+(fv?'&channel='+fv:'')).then(function(d){
            var h='<div class="fc"><div class="prs">';
            [['today','Hoje'],['tomorrow','Amanh√£'],['week','Semana'],['next-week','Pr√≥x. Semana'],['15days','15 Dias']].forEach(function(x){
                h+='<button class="per'+(period===x[0]?' on':'')+'" data-per="'+x[0]+'">'+x[1]+'</button>';
            });
            h+='</div><div><select id="fFlt"><option value="">Todos os canais</option>';
            allChannels.forEach(function(c){h+='<option value="'+c.id+'"'+(fv===c.id?' selected':'')+'>'+esc(c.name)+'</option>'});
            h+='</select></div></div>';
            h+='<div class="pg"><div class="pgi"><span>'+d.done+'/'+d.total+' conclu√≠dos</span><span class="pgp">'+d.pct+'%</span></div><div class="pgb"><div class="pgf" style="width:'+d.pct+'%"></div></div></div>';
            if(!d.groups.length){h+='<div class="em"><div class="emi">üìÖ</div><p>Nenhuma tarefa para este per√≠odo</p><small>Configure seus canais para gerar o fluxo</small></div>'}
            else{
                h+='<div class="tks">';
                d.groups.forEach(function(g){
                    h+='<div class="dh">üìÖ '+g.label+'</div>';
                    g.tasks.forEach(function(t){
                        h+='<div class="tk'+(t.done?' dn':'')+'" data-tk="'+t.key+'"><div class="ck">'+(t.done?'‚úì':'')+'</div><span class="ttime">'+t.time+'</span><div class="tch"><div class="ti" style="background:'+t.channel_color+'20;color:'+t.channel_color+'">'+t.channel_icon+'</div><span class="tn">'+esc(t.channel_name)+'</span></div></div>';
                    });
                });
                h+='</div>';
            }
            document.getElementById('pFluxo').innerHTML=h;
        });
    }

    // ‚îÄ‚îÄ‚îÄ Canais ‚îÄ‚îÄ‚îÄ
    function renderCanais(){
        loadChannels().then(function(chs){
            var h='<div class="chd"><h2>Seus Canais</h2><button class="btn bp" id="bNC">+ Novo Canal</button></div>';
            if(!chs.length){h+='<div class="em"><div class="emi">üì∫</div><p>Nenhum canal cadastrado</p><small>Crie seu primeiro canal</small></div>'}
            else{
                h+='<div class="cg">';
                chs.forEach(function(c){
                    h+='<div class="cc"><div class="ci" style="background:'+c.color+'20;color:'+c.color+'">'+c.icon+'</div><div class="cn"><h3>'+esc(c.name)+'</h3><p>'+c.freq_label+' ‚Ä¢ '+c.times.join(', ')+'</p></div><div class="ca"><button class="bi" data-ech="'+c.id+'">‚úè</button><button class="bi dg" data-dch="'+c.id+'">üóë</button></div></div>';
                });
                h+='</div>';
            }
            document.getElementById('pCanais').innerHTML=h;
        });
    }

    // ‚îÄ‚îÄ‚îÄ Prompts ‚îÄ‚îÄ‚îÄ
    function renderPrompts(){
        loadChannels().then(function(chs){
            var h='<div class="prl"><div class="prs2"><h3>Canais</h3><div class="pcl">';
            if(!chs.length) h+='<p style="font-size:13px;color:var(--t3);padding:8px">Nenhum canal</p>';
            else chs.forEach(function(c){
                h+='<button class="pc'+(curCh===c.id?' on':'')+'" data-pch="'+c.id+'">'+c.icon+' '+esc(c.name)+'<span class="pcn">'+c.prompt_count+'</span></button>';
            });
            h+='</div></div><div class="prm"><div class="prh"><h2>'+(curCh?esc((chs.find(function(c){return c.id===curCh})||{}).name||''):'Selecione um canal')+'</h2>';
            if(curCh) h+='<button class="btn bp" id="bNP">+ Novo Prompt</button>';
            h+='</div><div class="prls" id="prList">';
            if(!curCh){h+='<div class="em"><div class="emi">üìÑ</div><p>Selecione um canal para ver os prompts</p></div>'}
            h+='</div></div></div>';
            document.getElementById('pPrompts').innerHTML=h;
            if(curCh) loadPromptsList();
        });
    }

    function loadPromptsList(){
        api('/api/prompts/'+curCh).then(function(prs){
            var c=document.getElementById('prList');
            if(!prs.length){c.innerHTML='<div class="em"><div class="emi">üìÑ</div><p>Nenhum prompt cadastrado</p><small>Adicione prompts para organizar seu conte√∫do</small></div>';return}
            var h='';
            prs.forEach(function(p){
                h+='<div class="prc" data-vpr="'+p.id+'"><div class="pic">üìÑ</div><div class="pin"><h4>'+esc(p.name)+'</h4><p>'+esc((p.content||'').substring(0,100))+(p.content&&p.content.length>100?'...':'')+'</p></div><div class="pa"><button class="bi" data-epr="'+p.id+'">‚úè</button><button class="bi dg" data-dpr="'+p.id+'">üóë</button></div></div>';
            });
            c.innerHTML=h;
        });
    }

    // ‚îÄ‚îÄ‚îÄ Channel Modal ‚îÄ‚îÄ‚îÄ
    function openChModal(editId){
        var ch=editId?allChannels.find(function(c){return c.id===editId}):null;
        document.getElementById('mChT').textContent=ch?'Editar Canal':'Novo Canal';
        var icons=['üì∫','üé¨','üì±','üíª','üéµ','üéÆ','üì∏','‚ú®'];
        var colors=['#2563eb','#22d3ee','#10b981','#f59e0b','#ef4444','#ec4899'];
        var si=ch?ch.icon:'üì∫',sc=ch?ch.color:'#2563eb',fr=ch?ch.frequency:'1x_dia';
        var ts=ch?ch.times:['08:00'];
        var h='<div class="fg"><label>Nome do Canal *</label><input id="fN" value="'+esc(ch?ch.name:'')+'"></div><div class="fgr"><div class="fg"><label>√çcone</label><div class="pk">';
        icons.forEach(function(i){h+='<button type="button" class="pp ipp'+(i===si?' on':'')+'" data-v="'+i+'">'+i+'</button>'});
        h+='</div></div><div class="fg"><label>Cor</label><div class="pk">';
        colors.forEach(function(c){h+='<button type="button" class="pp cpp'+(c===sc?' on':'')+'" data-v="'+c+'" style="background:'+c+'"></button>'});
        h+='</div></div></div><div class="fg"><label>Frequ√™ncia *</label><select id="fFr">';
        [['1x_dia','1x por dia'],['2x_dia','2x por dia'],['3x_dia','3x por dia'],['dia_sim_nao','Dia sim, dia n√£o'],['dia_sim_nao_2x','Dia sim, dia n√£o (2x)'],['terca_quinta','Ter√ßa e Quinta']].forEach(function(x){h+='<option value="'+x[0]+'"'+(fr===x[0]?' selected':'')+'>'+x[1]+'</option>'});
        h+='</select></div><div class="fg"><label>Hor√°rios</label><div class="tms" id="fTms">';
        ts.forEach(function(t){h+='<div class="tr"><input type="time" value="'+t+'"><button type="button" class="bi rmt">‚úï</button></div>'});
        h+='</div><button type="button" class="btn bs bsm" id="aT">+ Hor√°rio</button></div>';
        h+='<div class="fg" id="fdG" style="display:'+(fr.indexOf('dia_sim_nao')>=0?'block':'none')+'"><label>Primeiro "Dia Sim"</label><input type="date" id="fFD" value="'+(ch&&ch.first_day_on?ch.first_day_on:'')+'"><small>Para "dia sim, dia n√£o"</small></div>';
        h+='<div class="mf"><button type="button" class="btn bs" data-close="mCh">Cancelar</button><button type="button" class="btn bp" id="svCh">Salvar</button></div>';
        document.getElementById('mChB').innerHTML=h;
        document.getElementById('mChB').dataset.eid=editId||'';
        document.getElementById('mCh').classList.add('on');
    }

    function saveCh(){
        var eid=document.getElementById('mChB').dataset.eid;
        var nm=document.getElementById('fN').value.trim();
        if(!nm)return;
        var ic=(document.querySelector('.ipp.on')||{}).dataset;ic=ic?ic.v:'üì∫';
        var cl=(document.querySelector('.cpp.on')||{}).dataset;cl=cl?cl.v:'#2563eb';
        var fr=document.getElementById('fFr').value;
        var ts=[];document.querySelectorAll('#fTms input[type=time]').forEach(function(i){if(i.value)ts.push(i.value)});
        var fd=document.getElementById('fFD');fd=fd?fd.value:null;
        var body={name:nm,icon:ic,color:cl,frequency:fr,times:ts.length?ts:['08:00'],first_day_on:fd||null};
        var url=eid?'/api/channels/'+eid:'/api/channels';
        var method=eid?'PUT':'POST';
        api(url,{method:method,body:JSON.stringify(body)}).then(function(){
            document.getElementById('mCh').classList.remove('on');
            refreshAll();
            toast(eid?'‚úÖ Canal atualizado!':'‚úÖ Canal criado!');
        });
    }

    function delCh(id){
        showConfirm('Excluir este canal e todos os seus prompts?',function(){
            api('/api/channels/'+id,{method:'DELETE'}).then(function(){
                if(curCh===id)curCh=null;
                refreshAll();
                toast('üóëÔ∏è Canal exclu√≠do');
            });
        });
    }

    // ‚îÄ‚îÄ‚îÄ Prompt Modal ‚îÄ‚îÄ‚îÄ
    function openPrModal(editId){
        if(editId){
            api('/api/prompts/'+editId+'/detail').then(function(pr){buildPrForm(pr)});
        } else {
            buildPrForm(null);
        }
    }

    function buildPrForm(pr){
        document.getElementById('mPrT').textContent=pr?'Editar Prompt':'Novo Prompt';
        var h='<div class="fg"><label>Nome *</label><input id="pN" value="'+esc(pr?pr.name:'')+'"></div>';
        h+='<div class="fg"><label>Categoria</label><input id="pCt" value="'+esc(pr?pr.category||'':'')+'"></div>';
        h+='<div class="fg"><label>Conte√∫do *</label><textarea id="pCo" rows="12">'+(pr?esc(pr.content):'')+'</textarea>';
        h+='<div class="taf"><span id="pCC">'+(pr?pr.content.length:0)+' caracteres</span><button type="button" class="bi" id="cpF">üìã</button></div></div>';
        h+='<div class="mf"><button type="button" class="btn bs" data-close="mPr">Cancelar</button><button type="button" class="btn bp" id="svPr">Salvar</button></div>';
        document.getElementById('mPrB').innerHTML=h;
        document.getElementById('mPrB').dataset.eid=pr?pr.id:'';
        document.getElementById('mPr').classList.add('on');
    }

    function savePr(){
        var eid=document.getElementById('mPrB').dataset.eid;
        var nm=document.getElementById('pN').value.trim();
        var co=document.getElementById('pCo').value;
        if(!nm||!co)return;
        var body={channel_id:curCh,name:nm,category:document.getElementById('pCt').value.trim(),content:co};
        var url=eid?'/api/prompts/'+eid:'/api/prompts';
        var method=eid?'PUT':'POST';
        api(url,{method:method,body:JSON.stringify(body)}).then(function(){
            document.getElementById('mPr').classList.remove('on');
            renderPrompts();
            toast(eid?'‚úÖ Prompt atualizado!':'‚úÖ Prompt salvo!');
        });
    }

    function delPr(id){
        showConfirm('Excluir este prompt?',function(){
            api('/api/prompts/'+id,{method:'DELETE'}).then(function(){
                renderPrompts();
                toast('üóëÔ∏è Prompt exclu√≠do');
            });
        });
    }

    function viewPr(id){
        api('/api/prompts/'+id+'/detail').then(function(p){
            document.getElementById('mVT').textContent=p.name;
            document.getElementById('mVP').textContent=p.content;
            document.getElementById('mV').classList.add('on');
        });
    }

    // ‚îÄ‚îÄ‚îÄ Conte√∫dos ‚îÄ‚îÄ‚îÄ
    var curCtCh=null, ctFilter='';

    function renderConteudos(){
        loadChannels().then(function(chs){
            var h='<div class="ctl"><div class="cts2"><h3>Canais</h3><div class="pcl">';
            if(!chs.length) h+='<p style="font-size:13px;color:var(--t3);padding:8px">Nenhum canal</p>';
            else chs.forEach(function(c){
                h+='<button class="pc'+(curCtCh===c.id?' on':'')+'" data-ctch="'+c.id+'">'+c.icon+' '+esc(c.name)+'<span class="pcn">'+c.content_count+'</span></button>';
            });
            h+='</div></div><div class="ctm"><div class="cth"><h2>üé¨ '+(curCtCh?esc((chs.find(function(c){return c.id===curCtCh})||{}).name||''):'Selecione um canal')+'</h2>';
            if(curCtCh) h+='<button class="btn bp" id="bNCt">+ Novo Conte√∫do</button>';
            h+='</div>';
            if(curCtCh){
                h+='<div class="ctfl"><button class="ctfb'+(ctFilter===''?' on':'')+'" data-ctf="">Todos</button><button class="ctfb'+(ctFilter==='pendente'?' on':'')+'" data-ctf="pendente">Pendentes</button><button class="ctfb'+(ctFilter==='publicado'?' on':'')+'" data-ctf="publicado">Publicados</button></div>';
                h+='<div class="ctls" id="ctList"><div class="em"><div class="emi">‚è≥</div><p>Carregando...</p></div></div>';
            } else {
                h+='<div class="ctls"><div class="em"><div class="emi">üé¨</div><p>Selecione um canal para ver os conte√∫dos</p></div></div>';
            }
            h+='</div></div>';
            document.getElementById('pConteudos').innerHTML=h;
            if(curCtCh) loadContentsList();
        });
    }

    function loadContentsList(){
        var url='/api/contents/'+curCtCh+(ctFilter?'?status='+ctFilter:'');
        api(url).then(function(cts){
            var c=document.getElementById('ctList');
            if(!cts.length){c.innerHTML='<div class="em"><div class="emi">üé¨</div><p>Nenhum conte√∫do '+(ctFilter==='pendente'?'pendente':ctFilter==='publicado'?'publicado':'cadastrado')+'</p><small>Adicione t√≠tulos para organizar sua produ√ß√£o</small></div>';return}
            var h='';
            cts.forEach(function(ct){
                var isPub=ct.status==='publicado';
                h+='<div class="cti'+(isPub?' pub':'')+'">';
                h+='<div class="ctck" data-cttg="'+ct.id+'">'+(isPub?'‚úì':'')+'</div>';
                if(ct.thumbnail){
                    h+='<img class="ctthumb" src="'+ct.thumbnail+'" data-ctimg="'+ct.id+'" alt="Thumb">';
                } else {
                    h+='<div class="ctnoimg">üñº</div>';
                }
                h+='<div class="ctinf"><h4>'+esc(ct.title)+'</h4>';
                if(isPub&&ct.published_at){
                    var d=ct.published_at.split('-');
                    h+='<span>Publicado em '+d[2]+'/'+d[1]+'/'+d[0]+'</span>';
                } else {
                    h+='<span>Pendente</span>';
                }
                h+='</div>';
                h+='<div class="pa"><button class="bi" data-ect="'+ct.id+'" data-ectt="'+esc(ct.title)+'" data-ectd="'+(ct.published_at||'')+'" data-ects="'+ct.status+'" data-ecti="'+(ct.thumbnail?'1':'')+'">‚úè</button><button class="bi dg" data-dct="'+ct.id+'">üóë</button></div>';
                h+='</div>';
            });
            c.innerHTML=h;
        });
    }

    var ctThumbData=null;
    function openCtModal(editId,editTitle,editDate,editStatus,hasThumb){
        document.getElementById('mCtT').textContent=editId?'Editar Conte√∫do':'Novo Conte√∫do';
        var st=editStatus||'pendente';
        ctThumbData=null;
        var h='<div class="fg"><label>T√≠tulo *</label><input id="ctN" value="'+esc(editTitle||'')+'" placeholder="Ex: Como fazer X em 5 minutos"></div>';
        h+='<div class="fg"><label>Thumbnail</label><div class="thumbup"><label>üìÅ Escolher imagem<input type="file" id="ctThFile" accept="image/*"></label></div><div id="ctThPrev"></div></div>';
        h+='<div class="fg"><label>Status</label><select id="ctS" style="width:100%;padding:10px 14px;background:var(--bg);border:1px solid var(--brd);border-radius:8px;color:var(--t1);font-family:var(--f);font-size:14px"><option value="pendente"'+(st==='pendente'?' selected':'')+'>üìù Pendente</option><option value="publicado"'+(st==='publicado'?' selected':'')+'>‚úÖ Publicado</option></select></div>';
        h+='<div class="fg"><label>Data de Publica√ß√£o</label><input id="ctD" type="date" value="'+(editDate||'')+'" style="width:100%;padding:10px 14px;background:var(--bg);border:1px solid var(--brd);border-radius:8px;color:var(--t1);font-family:var(--f);font-size:14px"></div>';
        h+='<div class="fg"><label>Observa√ß√£o</label><textarea id="ctNotes" rows="3" placeholder="Anota√ß√µes, links de refer√™ncia, ideias..." style="width:100%;padding:10px 14px;background:var(--bg);border:1px solid var(--brd);border-radius:8px;color:var(--t1);font-family:var(--f);font-size:14px;resize:vertical"></textarea></div>';
        h+='<div class="mf"><button type="button" class="btn bs" data-close="mCt">Cancelar</button><button type="button" class="btn bp" id="svCt">Salvar</button></div>';
        document.getElementById('mCtB').innerHTML=h;
        document.getElementById('mCtB').dataset.eid=editId||'';
        document.getElementById('mCt').classList.add('on');
        // Thumbnail file handler
        document.getElementById('ctThFile').onchange=function(e){
            var file=e.target.files[0];
            if(!file)return;
            if(file.size>3*1024*1024){toast('‚ö†Ô∏è Imagem muito grande (m√°x 3MB)');return}
            var reader=new FileReader();
            reader.onload=function(ev){
                ctThumbData=ev.target.result;
                document.getElementById('ctThPrev').innerHTML='<div class="thumbprev"><img src="'+ctThumbData+'"><button type="button" class="thumbrm" onclick="ctThumbData=\'remove\';this.parentElement.remove()">‚úï</button></div>';
            };
            reader.readAsDataURL(file);
        };
        // Load existing data if editing
        if(editId){
            api('/api/contents/'+editId+'/detail').then(function(ct){
                if(ct){
                    if(ct.thumbnail){
                        document.getElementById('ctThPrev').innerHTML='<div class="thumbprev"><img src="'+ct.thumbnail+'"><button type="button" class="thumbrm" onclick="ctThumbData=\'remove\';this.parentElement.remove()">‚úï</button></div>';
                    }
                    if(ct.notes){
                        document.getElementById('ctNotes').value=ct.notes;
                    }
                }
            }).catch(function(){});
        }
        setTimeout(function(){document.getElementById('ctN').focus()},100);
    }

    function saveCt(){
        var eid=document.getElementById('mCtB').dataset.eid;
        var nm=document.getElementById('ctN').value.trim();
        if(!nm)return;
        var st=document.getElementById('ctS').value;
        var dt=document.getElementById('ctD').value||null;
        var notes=document.getElementById('ctNotes').value.trim()||null;
        var body={channel_id:curCtCh,title:nm,status:st,published_at:dt,notes:notes};
        if(ctThumbData==='remove'){body.thumbnail=null}
        else if(ctThumbData){body.thumbnail=ctThumbData}
        var url=eid?'/api/contents/'+eid:'/api/contents';
        var method=eid?'PUT':'POST';
        api(url,{method:method,body:JSON.stringify(body)}).then(function(){
            document.getElementById('mCt').classList.remove('on');
            ctThumbData=null;
            loadContentsList();
            loadChannels();
            toast(eid?'‚úÖ Conte√∫do atualizado!':'‚úÖ Conte√∫do adicionado!');
        });
    }

    function toggleCt(id){
        var el=document.querySelector('[data-cttg="'+id+'"]');
        if(el){
            var row=el.closest('.cti');
            var wasPub=row.classList.contains('pub');
            if(wasPub){row.classList.remove('pub');el.textContent='';row.querySelector('.ctinf span').textContent='Pendente';row.querySelector('.ctinf h4').style.textDecoration='none';row.querySelector('.ctinf h4').style.color=''}
            else{row.classList.add('pub');el.textContent='‚úì';row.querySelector('.ctinf span').textContent='Publicado agora';row.querySelector('.ctinf h4').style.textDecoration='line-through';row.querySelector('.ctinf h4').style.color='var(--t3)'}
        }
        api('/api/contents/'+id+'/toggle',{method:'POST'}).then(function(){loadChannels()});
    }

    function delCt(id){
        showConfirm('Excluir este conte√∫do?',function(){
            api('/api/contents/'+id,{method:'DELETE'}).then(function(){
                loadContentsList();
                loadChannels();
                toast('üóëÔ∏è Conte√∫do exclu√≠do');
            });
        });
    }

    // ‚îÄ‚îÄ‚îÄ Conquistas ‚îÄ‚îÄ‚îÄ
    var achImgData=null;
    var currentAchChannel=null;
    function renderConquistas(){
        loadChannels().then(function(chs){
            api('/api/achievements').then(function(achs){
                var h='';
                if(!chs.length){
                    h+='<div class="achboardempty"><div style="font-size:48px">üì∫</div><p>Crie um canal primeiro para adicionar conquistas</p></div>';
                } else {
                    h+='<div class="achboard">';
                    chs.forEach(function(ch){
                        var chAchs=achs.filter(function(a){return a.channel_id===ch.id});
                        h+='<div class="achcol" style="border-top:3px solid '+ch.color+'">';
                        h+='<div class="achcolhd"><span class="icon">'+ch.icon+'</span><h3>'+esc(ch.name)+'</h3><span class="cnt">'+chAchs.length+'</span></div>';
                        h+='<div class="achcards">';
                        if(!chAchs.length){
                            h+='<div style="text-align:center;padding:20px;color:var(--t3);font-size:12px">Nenhuma conquista</div>';
                        } else {
                            chAchs.forEach(function(a){
                                h+='<div class="achcard" data-achview="'+a.id+'">';
                                if(a.image){
                                    h+='<img class="achcardimg" src="'+a.image+'" alt="Print">';
                                } else {
                                    h+='<div class="achcardnoimg">üèÜ</div>';
                                }
                                h+='<h4>'+esc(a.title)+'</h4>';
                                if(a.description) h+='<p>'+esc(a.description)+'</p>';
                                if(a.achieved_at){var d=a.achieved_at.split('-');h+='<div class="meta">üìÖ '+d[2]+'/'+d[1]+'/'+d[0]+'</div>';}
                                h+='<div class="actions"><button class="bi" data-each="'+a.id+'">‚úè</button><button class="bi dg" data-dach="'+a.id+'">üóë</button></div>';
                                h+='</div>';
                            });
                        }
                        h+='</div>';
                        h+='<div class="achcoladd"><button data-addach="'+ch.id+'">+ Adicionar Conquista</button></div>';
                        h+='</div>';
                    });
                    h+='</div>';
                }
                document.getElementById('pConquistas').innerHTML=h;
            });
        });
    }

    function openAchModal(editId, presetChannelId){
        document.getElementById('mAchT').textContent=editId?'Editar Conquista':'Nova Conquista';
        achImgData=null;
        currentAchChannel=presetChannelId||null;
        var h='<div class="fg"><label>T√≠tulo da Conquista *</label><input id="achN" placeholder="Ex: 1000 inscritos!"></div>';
        h+='<div class="fg"><label>Print/Imagem</label><div class="thumbup"><label>üìÅ Escolher imagem<input type="file" id="achFile" accept="image/*"></label></div><div id="achPrev"></div></div>';
        h+='<div class="fg"><label>Descri√ß√£o</label><textarea id="achDesc" rows="3" placeholder="Detalhes sobre essa conquista..." style="width:100%;padding:10px 14px;background:var(--bg);border:1px solid var(--brd);border-radius:8px;color:var(--t1);font-family:var(--f);font-size:14px;resize:vertical"></textarea></div>';
        h+='<div class="fg"><label>Data da Conquista</label><input id="achDate" type="date" style="width:100%;padding:10px 14px;background:var(--bg);border:1px solid var(--brd);border-radius:8px;color:var(--t1);font-family:var(--f);font-size:14px"></div>';
        if(!presetChannelId){
            h+='<div class="fg"><label>Canal *</label><select id="achCh" style="width:100%;padding:10px 14px;background:var(--bg);border:1px solid var(--brd);border-radius:8px;color:var(--t1);font-family:var(--f);font-size:14px" required><option value="">Selecione um canal</option>';
            allChannels.forEach(function(c){h+='<option value="'+c.id+'">'+c.icon+' '+esc(c.name)+'</option>';});
            h+='</select></div>';
        }
        h+='<div class="mf"><button type="button" class="btn bs" data-close="mAch">Cancelar</button><button type="button" class="btn bp" id="svAch">Salvar</button></div>';
        document.getElementById('mAchB').innerHTML=h;
        document.getElementById('mAchB').dataset.eid=editId||'';
        document.getElementById('mAch').classList.add('on');
        // File handler
        document.getElementById('achFile').onchange=function(e){
            var file=e.target.files[0];
            if(!file)return;
            if(file.size>3*1024*1024){toast('‚ö†Ô∏è Imagem muito grande (m√°x 3MB)');return}
            var reader=new FileReader();
            reader.onload=function(ev){
                achImgData=ev.target.result;
                document.getElementById('achPrev').innerHTML='<div class="thumbprev"><img src="'+achImgData+'"><button type="button" class="thumbrm" onclick="achImgData=\'remove\';this.parentElement.remove()">‚úï</button></div>';
            };
            reader.readAsDataURL(file);
        };
        // If editing, load existing data
        if(editId){
            api('/api/achievements/'+editId+'/detail').then(function(a){
                document.getElementById('achN').value=a.title||'';
                document.getElementById('achDesc').value=a.description||'';
                document.getElementById('achDate').value=a.achieved_at||'';
                currentAchChannel=a.channel_id;
                var chSel=document.getElementById('achCh');
                if(chSel)chSel.value=a.channel_id||'';
                if(a.image){
                    document.getElementById('achPrev').innerHTML='<div class="thumbprev"><img src="'+a.image+'"><button type="button" class="thumbrm" onclick="achImgData=\'remove\';this.parentElement.remove()">‚úï</button></div>';
                }
            });
        }
        setTimeout(function(){document.getElementById('achN').focus()},100);
    }

    function saveAch(){
        var eid=document.getElementById('mAchB').dataset.eid;
        var nm=document.getElementById('achN').value.trim();
        if(!nm)return;
        var chSel=document.getElementById('achCh');
        var channelId=currentAchChannel||(chSel?chSel.value:null);
        if(!channelId){toast('‚ö†Ô∏è Selecione um canal');return}
        var body={title:nm,description:document.getElementById('achDesc').value.trim()||null,achieved_at:document.getElementById('achDate').value||null,channel_id:channelId};
        if(achImgData==='remove'){body.image=null}
        else if(achImgData){body.image=achImgData}
        var url=eid?'/api/achievements/'+eid:'/api/achievements';
        var method=eid?'PUT':'POST';
        api(url,{method:method,body:JSON.stringify(body)}).then(function(){
            document.getElementById('mAch').classList.remove('on');
            achImgData=null;
            currentAchChannel=null;
            renderConquistas();
            toast(eid?'‚úÖ Conquista atualizada!':'üèÜ Conquista registrada!');
        });
    }

    function delAch(id){
        showConfirm('Excluir esta conquista?',function(){
            api('/api/achievements/'+id,{method:'DELETE'}).then(function(){
                renderConquistas();
                toast('üóëÔ∏è Conquista exclu√≠da');
            });
        });
    }

    // ‚îÄ‚îÄ‚îÄ Refresh ‚îÄ‚îÄ‚îÄ
    function refreshAll(){
        loadChannels().then(function(){renderFluxo();renderCanais();renderConteudos();renderPrompts();loadStats()});
    }

    // ‚îÄ‚îÄ‚îÄ Event Delegation ‚îÄ‚îÄ‚îÄ
    document.addEventListener('click',function(ev){
        var el=ev.target;
        function q(sel){return el.closest(sel)}
        var m;
        // Sidebar navigation - switch pages
        if((m=q('[data-nav]'))){
            ev.preventDefault();
            var nav=m.dataset.nav;
            document.querySelectorAll('.nl').forEach(function(n){n.classList.remove('on')});
            m.classList.add('on');
            document.querySelectorAll('.page').forEach(function(p){p.classList.remove('on')});
            if(nav==='planner'){
                document.getElementById('pagePlanner').classList.add('on');
            } else if(nav==='conquistas'){
                document.getElementById('pageConquistas').classList.add('on');
                renderConquistas();
            }
            return;
        }
        if(q('#btnLogout2')||q('#btnLogout3')){fetch('/api/auth/logout',{method:'POST'}).then(function(){window.location.href='/login'});return}
        if((m=q('.tab'))){document.querySelectorAll('.tab').forEach(function(b){b.classList.remove('on')});document.querySelectorAll('.pn').forEach(function(p){p.classList.remove('on')});m.classList.add('on');var nm=m.dataset.t;document.getElementById('p'+nm.charAt(0).toUpperCase()+nm.slice(1)).classList.add('on');return}
        if(q('#btnLogout')){fetch('/api/auth/logout',{method:'POST'}).then(function(){window.location.href='/login'});return}
        if((m=q('[data-per]'))){period=m.dataset.per;renderFluxo();return}
        if((m=q('[data-tk]'))){var tkEl=m;var wasDone=tkEl.classList.contains('dn');if(wasDone){tkEl.classList.remove('dn');tkEl.querySelector('.ck').textContent=''}else{tkEl.classList.add('dn');tkEl.querySelector('.ck').textContent='‚úì'}var allTk=document.querySelectorAll('.tk');var total=allTk.length;var done=0;allTk.forEach(function(t){if(t.classList.contains('dn'))done++});var pct=total?Math.round(done/total*100):0;var pi=document.querySelector('.pgi');if(pi){pi.innerHTML='<span>'+done+'/'+total+' conclu√≠dos</span><span class="pgp">'+pct+'%</span>'}var pf=document.querySelector('.pgf');if(pf)pf.style.width=pct+'%';api('/api/tasks/toggle',{method:'POST',body:JSON.stringify({key:m.dataset.tk})}).then(function(){loadStats()});return}
        if((m=q('[data-dch]'))){ev.stopPropagation();delCh(m.dataset.dch);return}
        if((m=q('[data-ech]'))){ev.stopPropagation();openChModal(m.dataset.ech);return}
        if(q('#bNC')){openChModal();return}
        if((m=q('.ipp'))){document.querySelectorAll('.ipp').forEach(function(b){b.classList.remove('on')});m.classList.add('on');return}
        if((m=q('.cpp'))){document.querySelectorAll('.cpp').forEach(function(b){b.classList.remove('on')});m.classList.add('on');return}
        if(q('#aT')){document.getElementById('fTms').insertAdjacentHTML('beforeend','<div class="tr"><input type="time" value="12:00"><button type="button" class="bi rmt">‚úï</button></div>');return}
        if((m=q('.rmt'))){var rows=document.querySelectorAll('#fTms .tr');if(rows.length>1)m.closest('.tr').remove();return}
        if(q('#svCh')){saveCh();return}
        // Contents handlers
        if((m=q('[data-dct]'))){ev.stopPropagation();delCt(m.dataset.dct);return}
        if((m=q('[data-ect]'))){ev.stopPropagation();openCtModal(m.dataset.ect,m.dataset.ectt,m.dataset.ectd,m.dataset.ects,m.dataset.ecti);return}
        if((m=q('[data-ctimg]'))){var img=m;document.getElementById('ctLbImg').src=img.src;document.getElementById('ctLightbox').classList.add('on');return}
        if((m=q('[data-cttg]'))){toggleCt(m.dataset.cttg);return}
        if((m=q('[data-ctch]'))){curCtCh=m.dataset.ctch;renderConteudos();return}
        if((m=q('[data-ctf]'))){ctFilter=m.dataset.ctf;renderConteudos();return}
        if(q('#bNCt')){openCtModal();return}
        if(q('#svCt')){saveCt();return}
        // Achievements handlers
        if((m=q('[data-dach]'))){ev.stopPropagation();delAch(m.dataset.dach);return}
        if((m=q('[data-each]'))){ev.stopPropagation();openAchModal(m.dataset.each);return}
        if((m=q('[data-addach]'))){openAchModal(null,m.dataset.addach);return}
        if((m=q('[data-achview]'))){var card=m;var img=card.querySelector('.achcardimg');if(img){document.getElementById('ctLbImg').src=img.src;document.getElementById('ctLightbox').classList.add('on');}return}
        if(q('#bNAch')){openAchModal();return}
        if(q('#svAch')){saveAch();return}
        if((m=q('[data-dpr]'))){ev.stopPropagation();delPr(m.dataset.dpr);return}
        if((m=q('[data-epr]'))){ev.stopPropagation();openPrModal(m.dataset.epr);return}
        if((m=q('[data-vpr]'))){viewPr(m.dataset.vpr);return}
        if((m=q('[data-pch]'))){curCh=m.dataset.pch;renderPrompts();return}
        if(q('#bNP')){openPrModal();return}
        if(q('#svPr')){savePr();return}
        if(q('#mVC')){navigator.clipboard.writeText(document.getElementById('mVP').textContent).then(function(){toast('üìã Copiado!')});return}
        if(q('#cpF')){var inp=document.getElementById('pCo');if(inp)navigator.clipboard.writeText(inp.value).then(function(){toast('üìã Copiado!')});return}
        if(q('#mConfYes')){document.getElementById('mConf').classList.remove('on');if(confirmCb){confirmCb();confirmCb=null}return}
        if((m=q('[data-close]'))){document.getElementById(m.dataset.close).classList.remove('on');return}
        if(el.classList.contains('mo')){el.classList.remove('on');return}
    });

    document.addEventListener('change',function(e){
        if(e.target.id==='fFr'){var g2=document.getElementById('fdG');if(g2)g2.style.display=e.target.value.indexOf('dia_sim_nao')>=0?'block':'none'}
        if(e.target.id==='fFlt')renderFluxo();
    });
    document.addEventListener('input',function(e){if(e.target.id==='pCo'){var c=document.getElementById('pCC');if(c)c.textContent=e.target.value.length+' caracteres'}});

    // ‚îÄ‚îÄ‚îÄ Init ‚îÄ‚îÄ‚îÄ
    refreshAll();
})();
</script>
</body>
</html>
